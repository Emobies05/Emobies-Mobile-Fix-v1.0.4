- name: Write build.gradle with signing
        run: |
          cat > android/app/build.gradle << 'EOF'
          plugins {
              id "com.android.application"
              id "kotlin-android"
              id "dev.flutter.flutter-gradle-plugin"
          }
          android {
              namespace "com.nxtbit.emobies_app"
              compileSdk 34
              compileOptions {
                  sourceCompatibility JavaVersion.VERSION_17
                  targetCompatibility JavaVersion.VERSION_17
              }
              kotlinOptions {
                  jvmTarget = "17"
              }
              defaultConfig {
                  applicationId "com.nxtbit.emobies_app"
                  minSdk 21
                  targetSdk 34
                  versionCode flutter.versionCode
                  versionName flutter.versionName
              }
              signingConfigs {
                  release {
                      storeFile file("emobies.keystore")
                      storePassword System.getenv("KEYSTORE_PASSWORD")
                      keyAlias System.getenv("KEY_ALIAS")
                      keyPassword System.getenv("KEY_PASSWORD")
                  }
              }
              buildTypes {
                  release {
                      signingConfig signingConfigs.release
                      minifyEnabled false
                      shrinkResources false
                  }
              }
          }
          flutter {
              source "../.."
          }
          EOF
